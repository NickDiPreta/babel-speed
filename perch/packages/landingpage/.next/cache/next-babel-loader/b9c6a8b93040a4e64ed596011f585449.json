{"ast":null,"code":"import nextConnect from \"next-connect\";\nimport middleware from \"../../middlewares/middleware\";\nimport multer from \"multer\";\nconst storage = multer.memoryStorage();\nconst upload = multer({\n  storage: storage\n});\nexport const config = {\n  api: {\n    bodyParser: false\n  }\n};\nconst handler = nextConnect();\nhandler.use(middleware);\nhandler.post(upload.single(\"file\"), async (req, res) => {\n  const signedUrl = \"https://wellick-lease-image-s3-stage.s3.amazonaws.com/lease-image-1-1600846125437?AWSAccessKeyId=AKIAWQRXSB72EUDRGGZB&Expires=1600849125&Signature=3EL9Qo2pIKMYHr5vL4g5T9rQ7sM%3D\";\n  let {\n    file\n  } = req;\n  console.log(typeof file.buffer);\n  let response;\n\n  if (file) {\n    response = await fetch(signedUrl, {\n      method: \"PUT\",\n      body: file.buffer,\n      headers: {\n        \"Content-Type\": file.mimetype\n      }\n    });\n  } else {\n    res.status(500).json({\n      statusText: \"No image selected\"\n    });\n    return;\n  }\n\n  console.log(response);\n  res.status(response.status).json(response);\n});\nexport default handler;","map":{"version":3,"sources":["/Users/jackiedong/Documents/perch/perchcredit.github.io/perch/packages/landingpage/pages/api/upload-lease.js"],"names":["nextConnect","middleware","multer","storage","memoryStorage","upload","config","api","bodyParser","handler","use","post","single","req","res","signedUrl","file","console","log","buffer","response","fetch","method","body","headers","mimetype","status","json","statusText"],"mappings":"AAAA,OAAOA,WAAP,MAAwB,cAAxB;AACA,OAAOC,UAAP,MAAuB,8BAAvB;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,MAAMC,OAAO,GAAGD,MAAM,CAACE,aAAP,EAAhB;AACA,MAAMC,MAAM,GAAGH,MAAM,CAAC;AAAEC,EAAAA,OAAO,EAAEA;AAAX,CAAD,CAArB;AAEA,OAAO,MAAMG,MAAM,GAAG;AACpBC,EAAAA,GAAG,EAAE;AACHC,IAAAA,UAAU,EAAE;AADT;AADe,CAAf;AAMP,MAAMC,OAAO,GAAGT,WAAW,EAA3B;AACAS,OAAO,CAACC,GAAR,CAAYT,UAAZ;AAEAQ,OAAO,CAACE,IAAR,CAAaN,MAAM,CAACO,MAAP,CAAc,MAAd,CAAb,EAAoC,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACtD,QAAMC,SAAS,GACb,mLADF;AAEA,MAAI;AAAEC,IAAAA;AAAF,MAAWH,GAAf;AAEAI,EAAAA,OAAO,CAACC,GAAR,CAAY,OAAOF,IAAI,CAACG,MAAxB;AAEA,MAAIC,QAAJ;;AACA,MAAIJ,IAAJ,EAAU;AACRI,IAAAA,QAAQ,GAAG,MAAMC,KAAK,CAACN,SAAD,EAAY;AAChCO,MAAAA,MAAM,EAAE,KADwB;AAEhCC,MAAAA,IAAI,EAAEP,IAAI,CAACG,MAFqB;AAGhCK,MAAAA,OAAO,EAAE;AACP,wBAAgBR,IAAI,CAACS;AADd;AAHuB,KAAZ,CAAtB;AAOD,GARD,MAQO;AACLX,IAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,UAAU,EAAE;AAAd,KAArB;AACA;AACD;;AAEDX,EAAAA,OAAO,CAACC,GAAR,CAAYE,QAAZ;AACAN,EAAAA,GAAG,CAACY,MAAJ,CAAWN,QAAQ,CAACM,MAApB,EAA4BC,IAA5B,CAAiCP,QAAjC;AACD,CAvBD;AAyBA,eAAeX,OAAf","sourcesContent":["import nextConnect from \"next-connect\";\nimport middleware from \"../../middlewares/middleware\";\nimport multer from \"multer\";\nconst storage = multer.memoryStorage();\nconst upload = multer({ storage: storage });\n\nexport const config = {\n  api: {\n    bodyParser: false,\n  },\n};\n\nconst handler = nextConnect();\nhandler.use(middleware);\n\nhandler.post(upload.single(\"file\"), async (req, res) => {\n  const signedUrl =\n    \"https://wellick-lease-image-s3-stage.s3.amazonaws.com/lease-image-1-1600846125437?AWSAccessKeyId=AKIAWQRXSB72EUDRGGZB&Expires=1600849125&Signature=3EL9Qo2pIKMYHr5vL4g5T9rQ7sM%3D\";\n  let { file } = req;\n\n  console.log(typeof file.buffer);\n\n  let response;\n  if (file) {\n    response = await fetch(signedUrl, {\n      method: \"PUT\",\n      body: file.buffer,\n      headers: {\n        \"Content-Type\": file.mimetype,\n      },\n    });\n  } else {\n    res.status(500).json({ statusText: \"No image selected\" });\n    return;\n  }\n\n  console.log(response);\n  res.status(response.status).json(response);\n});\n\nexport default handler;\n"]},"metadata":{},"sourceType":"module"}