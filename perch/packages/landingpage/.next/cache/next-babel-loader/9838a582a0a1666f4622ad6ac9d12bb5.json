{"ast":null,"code":"import Cors from \"cors\";\nimport initMiddleware from \"../../lib/init-middleware\";\nimport multer from \"multer\";\nconst upload = multer({\n  dest: \"/tmp\"\n}); // Initialize the cors middleware\n\nconst cors = initMiddleware(Cors({\n  // Only allow requests with GET, POST and PUT\n  methods: [\"GET\", \"POST\", \"PUT\"]\n}));\nexport const config = {\n  api: {\n    bodyParser: false\n  }\n};\nhandler.post(upload.single(\"file\"), async (req, res) => {\n  // Run cors\n  await cors(req, res);\n  const signedUrl = \"https://wellick-lease-image-s3-stage.s3.amazonaws.com/lease-image-1-1599786710182?AWSAccessKeyId=AKIAWQRXSB72EUDRGGZB&Expires=1600841263&Signature=ChdcYROKYj55w6jM7lIIX6b9UGo%3D\";\n  let {\n    type\n  } = req.body;\n  console.log(file);\n  let res2;\n\n  if (file) {\n    res2 = await fetch(signedUrl, {\n      method: \"PUT\",\n      body: file,\n      headers: {\n        \"Content-Type\": type\n      }\n    });\n  } else {\n    res.status(500).json({\n      statusText: \"No image selected\"\n    });\n    return;\n  }\n\n  res.json(res2);\n});\nexport default handler;","map":{"version":3,"sources":["/Users/jackiedong/Documents/perch/perchcredit.github.io/perch/packages/landingpage/pages/api/upload-lease.js"],"names":["Cors","initMiddleware","multer","upload","dest","cors","methods","config","api","bodyParser","handler","post","single","req","res","signedUrl","type","body","console","log","file","res2","fetch","method","headers","status","json","statusText"],"mappings":"AAAA,OAAOA,IAAP,MAAiB,MAAjB;AACA,OAAOC,cAAP,MAA2B,2BAA3B;AACA,OAAOC,MAAP,MAAmB,QAAnB;AACA,MAAMC,MAAM,GAAGD,MAAM,CAAC;AAAEE,EAAAA,IAAI,EAAE;AAAR,CAAD,CAArB,C,CAEA;;AACA,MAAMC,IAAI,GAAGJ,cAAc,CACzBD,IAAI,CAAC;AACH;AACAM,EAAAA,OAAO,EAAE,CAAC,KAAD,EAAQ,MAAR,EAAgB,KAAhB;AAFN,CAAD,CADqB,CAA3B;AAOA,OAAO,MAAMC,MAAM,GAAG;AACpBC,EAAAA,GAAG,EAAE;AACHC,IAAAA,UAAU,EAAE;AADT;AADe,CAAf;AAMPC,OAAO,CAACC,IAAR,CAAaR,MAAM,CAACS,MAAP,CAAc,MAAd,CAAb,EAAoC,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACtD;AACA,QAAMT,IAAI,CAACQ,GAAD,EAAMC,GAAN,CAAV;AAEA,QAAMC,SAAS,GACb,mLADF;AAEA,MAAI;AAAEC,IAAAA;AAAF,MAAWH,GAAG,CAACI,IAAnB;AACAC,EAAAA,OAAO,CAACC,GAAR,CAAYC,IAAZ;AACA,MAAIC,IAAJ;;AACA,MAAID,IAAJ,EAAU;AACRC,IAAAA,IAAI,GAAG,MAAMC,KAAK,CAACP,SAAD,EAAY;AAC5BQ,MAAAA,MAAM,EAAE,KADoB;AAE5BN,MAAAA,IAAI,EAAEG,IAFsB;AAG5BI,MAAAA,OAAO,EAAE;AACP,wBAAgBR;AADT;AAHmB,KAAZ,CAAlB;AAOD,GARD,MAQO;AACLF,IAAAA,GAAG,CAACW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,UAAU,EAAE;AAAd,KAArB;AACA;AACD;;AACDb,EAAAA,GAAG,CAACY,IAAJ,CAASL,IAAT;AACD,CAtBD;AAwBA,eAAeX,OAAf","sourcesContent":["import Cors from \"cors\";\nimport initMiddleware from \"../../lib/init-middleware\";\nimport multer from \"multer\";\nconst upload = multer({ dest: \"/tmp\" });\n\n// Initialize the cors middleware\nconst cors = initMiddleware(\n  Cors({\n    // Only allow requests with GET, POST and PUT\n    methods: [\"GET\", \"POST\", \"PUT\"],\n  })\n);\n\nexport const config = {\n  api: {\n    bodyParser: false,\n  },\n};\n\nhandler.post(upload.single(\"file\"), async (req, res) => {\n  // Run cors\n  await cors(req, res);\n\n  const signedUrl =\n    \"https://wellick-lease-image-s3-stage.s3.amazonaws.com/lease-image-1-1599786710182?AWSAccessKeyId=AKIAWQRXSB72EUDRGGZB&Expires=1600841263&Signature=ChdcYROKYj55w6jM7lIIX6b9UGo%3D\";\n  let { type } = req.body;\n  console.log(file);\n  let res2;\n  if (file) {\n    res2 = await fetch(signedUrl, {\n      method: \"PUT\",\n      body: file,\n      headers: {\n        \"Content-Type\": type,\n      },\n    });\n  } else {\n    res.status(500).json({ statusText: \"No image selected\" });\n    return;\n  }\n  res.json(res2);\n});\n\nexport default handler;\n"]},"metadata":{},"sourceType":"module"}